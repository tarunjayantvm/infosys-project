<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor — AI Vision Extract</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        /* quick editor-specific tweaks */
        .editor-shell { padding: 3rem 0; }
        .editor-canvas-wrap { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 12px; }
        .tool-btn { width: 56px; height: 56px; display:flex; align-items:center; justify-content:center; border-radius:10px; background: transparent; border:1px solid var(--border-color); color:var(--text-secondary); }
        .tool-btn.active { background: linear-gradient(180deg, rgba(0,212,255,0.06), rgba(131,56,236,0.04)); color:var(--primary-color); border-color: rgba(0,212,255,0.14); }
        .editor-sidebar { background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-card-light) 100%); border:1px solid var(--border-color); border-radius:12px; padding:16px; }
        .canvas-area { display:flex; align-items:center; justify-content:center; min-height:520px; }
        .editor-topbar { margin-bottom:1rem; display:flex; justify-content:space-between; gap:12px; align-items:center; }
        .small-muted { color:var(--text-muted); font-size:0.9rem; }
    </style>
</head>
<body class="dark-theme">
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/">
                <i class="fas fa-magic"></i> AI Vision Extract
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Features</a></li>
                    <li class="nav-item"><a class="nav-link active" href="/editor">Editor</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="editor-shell">
        <div class="container">
            <div class="editor-topbar">
                <div class="d-flex gap-3 align-items-center">
                    <label class="btn btn-primary" for="editorFileInput"><i class="fas fa-upload me-2"></i>Open Image</label>
                    <input type="file" id="editorFileInput" accept="image/*" style="display:none">
                    <button class="btn btn-secondary" id="undoBtn"><i class="fas fa-undo me-2"></i>Undo</button>
                    <button class="btn btn-secondary" id="resetBtn"><i class="fas fa-eraser me-2"></i>Reset</button>
                    <a class="btn btn-outline-primary" href="/"><i class="fas fa-arrow-left me-2"></i>Back</a>
                </div>
                <div class="d-flex gap-2 align-items-center">
                    <div class="small-muted text-end">Export &nbsp;</div>
                    <button class="btn btn-success" id="exportBtn"><i class="fas fa-download me-2"></i>Export PNG</button>
                </div>
            </div>

            <div class="row g-4">
                <div class="col-lg-2">
                    <div class="d-grid gap-3">
                        <button class="tool-btn" id="tool-select" title="Select / Crop"><i class="fas fa-crop"></i></button>
                        <button class="tool-btn" id="tool-lasso" title="Freehand Lasso"><i class="fas fa-draw-polygon"></i></button>
                        <button class="tool-btn" id="tool-rotate" title="Rotate 90°"><i class="fas fa-rotate-right"></i></button>
                        <button class="tool-btn" id="tool-flip-h" title="Flip Horizontal"><i class="fas fa-arrows-alt-h"></i></button>
                        <button class="tool-btn" id="tool-flip-v" title="Flip Vertical"><i class="fas fa-arrows-alt-v"></i></button>
                        <button class="tool-btn" id="tool-resize" title="Resize"><i class="fas fa-expand"></i></button>
                    </div>
                </div>

                <div class="col-lg-7">
                    <div class="editor-canvas-wrap">
                        <div class="canvas-area">
                            <canvas id="editorCanvas" width="900" height="600" style="background:var(--bg-card-light); border-radius:8px;"></canvas>
                        </div>
                    </div>
                    <div class="mt-3 small-muted">Tip: Use the tools on the left. Crop uses click-and-drag. Lasso draws a freehand selection.</div>
                </div>

                <div class="col-lg-3">
                    <div class="editor-sidebar">
                        <h5 class="fw-bold">Tool Options</h5>
                        <div id="toolOptions" class="mt-3">
                            <div id="options-default" class="tool-options-block">
                                <p class="small-muted">No tool selected. Open an image to begin editing.</p>
                            </div>

                            <div id="options-resize" class="tool-options-block" style="display:none">
                                <label class="small-muted">Width (px)</label>
                                <input id="resizeWidth" type="number" class="form-control mb-2" />
                                <label class="small-muted">Height (px)</label>
                                <input id="resizeHeight" type="number" class="form-control mb-2" />
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="resizeKeepAspect" checked>
                                    <label class="form-check-label small-muted" for="resizeKeepAspect">Keep aspect ratio</label>
                                </div>
                                <button class="btn btn-primary w-100" id="applyResize">Apply Resize</button>
                            </div>

                            <div id="options-crop" class="tool-options-block" style="display:none">
                                <p class="small-muted">Drag on canvas to create a crop area, then click Apply Crop.</p>
                                <button class="btn btn-primary w-100" id="applyCrop">Apply Crop</button>
                            </div>

                            <div id="options-lasso" class="tool-options-block" style="display:none">
                                <p class="small-muted">Draw freehand selection on the canvas, then click Apply Mask to keep selected area.</p>
                                <button class="btn btn-primary w-100" id="applyLasso">Apply Mask</button>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/editor.js') }}"></script>
</body>
</html>
